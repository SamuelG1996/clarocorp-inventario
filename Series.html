<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Portal Inventario || Series </title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="menu-page formulario-traspaso">
  <div class="contenedor">
    
    <a href="Stock.html" class="volver">
      <i class="fas fa-arrow-left"></i> Volver a Stock Contrata
    </a>

    <h2><i class="fas fa-barcode"></i> Control de Series</h2>

    <div class="acciones-tabla acciones-series">
      <button onclick="descargarExcelSeries()">
        <i class="fas fa-file-excel"></i> Descargar Excel
      </button>
      <button onclick="guardarCambios()">
        <i class="fas fa-save"></i> Grabar
      </button>
    </div>
 <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Buscar por serie, código, lote..." onkeyup="filtrarTabla()">
    </div>
      <div class="tabla-datos">
      <table id="tablaSeries">
        <thead>
          <tr>
            <th>Código</th>
            <th>Descripción</th>
            <th>Centro</th>
            <th>Almacén</th>
            <th>Lote</th>
            <th>N° Serie</th>
            <th>Empresa</th>
            <th>Fecha Ingreso</th>
            <th>Estado Contrata</th>            
            <th>SOT/PY</th>      
            <th>Cliente</th>       
            <th>ID Devolución/GR</th> 
            <th>Fecha Estado Contrata</th>
            <th>Comentario Contrata</th>
            <th>Antiguamiento</th>
            <th>Estado Soporte</th>
            <th>Comentario Soporte</th>
            <th>Fecha Estado Soporte</th>
          </tr>
        </thead>
        <tbody id="series-body">
          <!-- Contenido dinámico -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    function logout() {
      localStorage.clear();
      window.location.href = "index.html";
    }

      function descargarExcelSeries() {
    const tabla = document.getElementById("tablaSeries");
    const wb = XLSX.utils.book_new();
    const ws = XLSX.utils.table_to_sheet(tabla);
    XLSX.utils.book_append_sheet(wb, ws, "Series FIFO");
    XLSX.writeFile(wb, "Series_FIFO_ClaroCorp.xlsx");
  }

    function filtrarTabla() {
      const input = document.getElementById("searchInput").value.toLowerCase().trim();
      const filtros = input.split(/\s+/);
      const filas = document.querySelectorAll("#tablaSeries tbody tr");

      filas.forEach(fila => {
        const textoFila = Array.from(fila.cells).map(td => td.textContent.toLowerCase()).join(" ");
        const coincide = filtros.every(f => textoFila.includes(f));
        fila.style.display = coincide ? "" : "none";
      });
    }
  </script>
  <script>
async function guardarCambios() {
  Swal.fire({
    icon: 'info',
    title: 'Guardar Cambios',
    text: 'Esta función aún no está implementada.',
    position: 'bottom-end',
    showConfirmButton: false,
    timer: 3000,
    background: '#1e2022',
    color: '#ffffff',
    iconColor: '#f39c12'
  });
}
  </script>
  
  <script src="Js/Sesion.js"></script>
</body>
</html>
